{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# TEM3パッケージ\n",
    "TEMの制御を行う。  \n",
    "TEM3をインストールしていないため、offlineで実行する"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "from PyJEM.offline import TEM3\n",
    "#from PyJEM import TEM3"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Help on package PyJEM.offline.TEM3 in PyJEM.offline:\n",
      "\n",
      "NAME\n",
      "    PyJEM.offline.TEM3 - # -*- coding: utf-8 -*-\n",
      "\n",
      "PACKAGE CONTENTS\n",
      "    apt3\n",
      "    camera3\n",
      "    def3\n",
      "    detector3\n",
      "    eos3\n",
      "    feg3\n",
      "    filter3\n",
      "    gun3\n",
      "    ht3\n",
      "    lens3\n",
      "    mds3\n",
      "    scan3\n",
      "    stage3\n",
      "    vacuum3\n",
      "\n",
      "DATA\n",
      "    eosdata_file = r'C:\\Anaconda3\\lib\\site-packages\\PyJEM\\offline\\resource...\n",
      "    f = <_io.TextIOWrapper name='C:\\\\Anaconda3\\\\lib\\\\sit...ine_tem3eos_dat...\n",
      "    listnamelist = ['MagList', 'SpctrList', 'StemCamList']\n",
      "    offline_path = r'C:\\Anaconda3\\lib\\site-packages\\PyJEM\\offline'\n",
      "    offlinedata = {'STEMAMAG': {'MagList': [[5000, 'X', 'x5000'], [6000, '...\n",
      "    stem_funcmodelist = ['Align', 'SM-LMAG', 'SM-MAG', 'AMAG', 'uuDIFF', '...\n",
      "    tem_funcmodelist = ['MAG', 'MAG2', 'LowMAG', 'SAMAG', 'DIFF']\n",
      "\n",
      "FILE\n",
      "    c:\\anaconda3\\lib\\site-packages\\pyjem\\offline\\tem3\\__init__.py\n",
      "\n",
      "\n"
     ]
    }
   ],
   "source": [
    "help(TEM3)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Aperture\n",
    "Apertureの制御を行う  \n",
    "SetKindで指定したApertureに対して制御が行われる。"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [],
   "source": [
    "# 初期処理\n",
    "apt = TEM3.Apt3()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Help on Apt3 in module PyJEM.offline.TEM3.apt3 object:\n",
      "\n",
      "class Apt3(builtins.object)\n",
      " |  Methods defined here:\n",
      " |  \n",
      " |  GetKind(self)\n",
      " |      | **Summary**\n",
      " |      | Get the type of selected Aperture. Below is the Aperture indicated by the Return.\n",
      " |      | **return**\n",
      " |      | type: int\n",
      " |      | 0=Nothing, 1=CLA, 2=OLA, 3=HCA, 4=SAA, 5=ENTA, 6=EDS\n",
      " |  \n",
      " |  GetPosition(self)\n",
      " |      | **Summary**\n",
      " |      | Get Aperture position. The Selected Aperture is the Reading Target.\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | [0]=x, [1]=y\n",
      " |  \n",
      " |  GetSize(self, sel_kind)\n",
      " |      | **Summary**\n",
      " |      | Get Aperture number.\n",
      " |      | **return**\n",
      " |      | type： int\n",
      " |      | 0=Open, 1-4=Number\n",
      " |  \n",
      " |  SelectKind(self, kind)\n",
      " |      | **Summary**\n",
      " |      | SelectKindSelect Aperture type.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | kind: 0=Nothing 1=CLA, 2=OLA, 3=HCA, 4=SAA, 5=ENTA, 6=EDS\n",
      " |  \n",
      " |  SetPosition(self, x, y)\n",
      " |      | **Summary**\n",
      " |      | Set Aperture position. The Selected Aperture is the Operation Target.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | x: 0-4095, y: 0-4095\n",
      " |  \n",
      " |  SetSize(self, size)\n",
      " |      | **Summary**\n",
      " |      | Set Aperture number. The Selected Aperture is the Operation Target.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | size: 0=Open, 1-4=Number\n",
      " |  \n",
      " |  __init__(self)\n",
      " |      Initialize self.  See help(type(self)) for accurate signature.\n",
      " |  \n",
      " |  ----------------------------------------------------------------------\n",
      " |  Data descriptors defined here:\n",
      " |  \n",
      " |  __dict__\n",
      " |      dictionary for instance variables (if defined)\n",
      " |  \n",
      " |  __weakref__\n",
      " |      list of weak references to the object (if defined)\n",
      "\n"
     ]
    }
   ],
   "source": [
    "help(apt)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "apt.SetPosition(245,256)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[245, 256]"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "apt.GetPosition()"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "## Deflector\n",
    "Deflectorの制御を行う  "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# 初期処理\n",
    "de = TEM3.Def3()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Help on Def3 in module PyJEM.offline.TEM3.def3 object:\n",
      "\n",
      "class Def3(builtins.object)\n",
      " |  Methods defined here:\n",
      " |  \n",
      " |  GetAngBal(self)\n",
      " |      | **Summary**\n",
      " |      | Get AngleBalance value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetBeamBlank(self)\n",
      " |      | **Summary**\n",
      " |      | Get Beam branking status, 1:ON. Branking method is defined on machine side.\n",
      " |      | **return**\n",
      " |      | type: int\n",
      " |      | 1=ON\n",
      " |  \n",
      " |  GetCLA1(self)\n",
      " |      | **Summary**\n",
      " |      | Get CLAlignment1 value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetCLA2(self)\n",
      " |      | **Summary**\n",
      " |      | Get CLAlignment2 value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetCLs(self)\n",
      " |      | **Summary**\n",
      " |      | Get CLStig value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetCorrection(self)\n",
      " |      | **Summary**\n",
      " |      | Get Collection value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetDetAlign(self)\n",
      " |      | **Summary**\n",
      " |      | Get Alignment value for detector. this returns the variable corresponds to IS value overlapped to CLA. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetFLA1(self)\n",
      " |      | **Summary**\n",
      " |      | Get FLAlignment1 value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetFLA2(self)\n",
      " |      | **Summary**\n",
      " |      | Get FLAlignment2 value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetFLs1(self)\n",
      " |      | **Summary**\n",
      " |      | Get FLStig1 value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetFLs2(self)\n",
      " |      | **Summary**\n",
      " |      | Get FLStig2 value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetGunA1(self)\n",
      " |      | **Summary**\n",
      " |      | Get GunAlignment1 value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetGunA2(self)\n",
      " |      | **Summary**\n",
      " |      | Get GunAlignment2 value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetILs(self)\n",
      " |      | **Summary**\n",
      " |      | Get ILStig value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetIS1(self)\n",
      " |      | **Summary**\n",
      " |      | Get ImageShift1 value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetIS2(self)\n",
      " |      | **Summary**\n",
      " |      | Get ImageShift2 value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetMagAdjust(self)\n",
      " |      | **Summary**\n",
      " |      | Get MagAdjust value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetOLs(self)\n",
      " |      | **Summary**\n",
      " |      | Get OLStig value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetOffset(self)\n",
      " |      | **Summary**\n",
      " |      | Get Offset value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetPLA(self)\n",
      " |      | **Summary**\n",
      " |      | Get PLAlign value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetRotation(self)\n",
      " |      | **Summary**\n",
      " |      | Get Rotation value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetScan1(self)\n",
      " |      | **Summary**\n",
      " |      | Get Scan1 value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetScan2(self)\n",
      " |      | **Summary**\n",
      " |      | Get Scan2 value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetShifBal(self)\n",
      " |      | **Summary**\n",
      " |      | Get ShiftBalance value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetSpotA(self)\n",
      " |      | **Summary**\n",
      " |      | Get SpotAlignment value. this returns I/O output value. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetStemIS(self)\n",
      " |      | **Summary**\n",
      " |      | Get IS value for ASID. The variable corresponds to IS value overlapped to CLA. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  GetTiltBal(self)\n",
      " |      | **Summary**\n",
      " |      | Get TiltBalance value for ASID. The variable corresponds to IS value overlapped to CLA. Range:0-FFFF(H)\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | 0-65535\n",
      " |  \n",
      " |  SetAngBal(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set AngleBalance value. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetBeamBlank(self, sw)\n",
      " |      | **Summary**\n",
      " |      | ON/OFF Beam branking. Branking method is defined on machine side.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | sw: 0=OFF, 1=ON\n",
      " |  \n",
      " |  SetCLA1(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set CLAlignment1 value. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetCLA2(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set CLAlignment2 value. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetCLs(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set CLStig value. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetDetAlign(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set Alignment value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetFLA1(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set FLAlignment1 value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetFLA2(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set FLAlignment2 value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetFLs1(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set FLStig1 value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetFLs2(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set FLStig2 value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetGunA1(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set GunAlignment1 value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetGunA2(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set GunAlignment2 value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetILs(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set ILStig value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetIS1(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set ImageShift1 value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetIS2(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set ImageShift2 value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetNtrl(self, def_id)\n",
      " |      | **Summary**\n",
      " |      | NTRL of the region which is being accessed.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | def_id: 0=GUN1, 1=GUN2, 2=CLA1, 3=CLA2, 4=CMP-S, 5=CMP-T. 6=CMT-A, 7=CLS, 8=ISC1, 9=ISC2, 10=SPA,\n",
      " |      11=PLA, 12=OLS, 13=ILS, 14=FLS1, 15=FLS2, 16=FLA1, 17=FLA2, 18=SCAN1, 19=SCAN2,\n",
      " |      20=IS-ASID, 21=MAG-ADJ, 22=ROTATION, 23=CORRECTION, 24=OFFSET\n",
      " |  \n",
      " |  SetOLs(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set OLStig value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetPLA(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set PLAlign value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetScan1(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set Scan1 value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetScan2(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set Scan2 value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetShifBal(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set ShiftBalance value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetStemA1CoarseRel(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Increase or decrease A1 Coarse value for STEM. This works for ARM200F\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetStemBeamTiltRel(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Increase or decrease Beam Tilt value for STEM. This works for ARM200F\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetStemIS(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set IS value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetStemStigA1Rel(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Increase or decrease Stig A1 value for STEM. This works for ARM200F\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetStemStigB2Rel(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Increase or decrease Stig B2 value for STEM. This works for ARM200F\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetStemUserBShiftRel(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Increase or decrease User B Shift value for STEM. This works for ARM200F\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetTemA1CoarseRel(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Increase or decrease A1 Coarse value for TEM. This works for ARM200F\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetTemDShiftRel(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Increase or decrease D Shift value for TEM. This works for ARM200F\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetTemDiStigRel(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Increase or decrease D Stig value for TEM. This works for ARM200F\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetTemStigA1Rel(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Increase or decrease A1 Stig value for TEM. This works for ARM200F\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  SetTiltBal(self, arg1, arg2)\n",
      " |      | **Summary**\n",
      " |      | Set Tilt Balance value for detector. The variable corresponds to I/O output value.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | arg1: 0-65535, arg2: 0-65535\n",
      " |  \n",
      " |  __init__(self)\n",
      " |      Initialize self.  See help(type(self)) for accurate signature.\n",
      " |  \n",
      " |  ----------------------------------------------------------------------\n",
      " |  Data descriptors defined here:\n",
      " |  \n",
      " |  __dict__\n",
      " |      dictionary for instance variables (if defined)\n",
      " |  \n",
      " |  __weakref__\n",
      " |      list of weak references to the object (if defined)\n",
      "\n"
     ]
    }
   ],
   "source": [
    "#関数一覧の表示\n",
    "help(de)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[32768, 32768]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# CLAlignment1座標の取得\n",
    "de.GetCLA1()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# CLAlignment1座標の移動\n",
    "de.SetCLA1(4095,4095)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "## Eos"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# 初期処理\n",
    "eos = TEM3.EOS3()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Help on EOS3 in module PyJEM.offline.TEM3.eos3 object:\n",
      "\n",
      "class EOS3(builtins.object)\n",
      " |  Methods defined here:\n",
      " |  \n",
      " |  DownSelector(self)\n",
      " |      | **Summary**\n",
      " |      | Decrement Magnification/Camera length/Rocking angle number. Down the magnification selector.\n",
      " |  \n",
      " |  DownSpctrSelector(self)\n",
      " |      | **Summary**\n",
      " |      | Decrement spectrum magnification number. Down the energy spectrometer selector.\n",
      " |  \n",
      " |  DownStemCamSelector(self)\n",
      " |      | **Summary**\n",
      " |      | Decrement imaging side camera length(magnification) number for STEM. Down the camera length selector.\n",
      " |  \n",
      " |  GetAlpha(self)\n",
      " |      | **Summary**\n",
      " |      | Get alpha number.\n",
      " |      | **return**\n",
      " |      | type: int\n",
      " |      | 0-8\n",
      " |  \n",
      " |  GetAlphaSelectorEx(self)\n",
      " |      | **Summary**\n",
      " |      | Get alpha number and string.\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | [0]= Alpha number, int\n",
      " |      | [1]= Alpha Name, string\n",
      " |  \n",
      " |  GetCurrentMagSelectorID(self)\n",
      " |      | **Summary**\n",
      " |      | Get MAG selector UD and Magnification value.\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | [0]= MAG selector ID, int\n",
      " |      | [1]= Magnification value, int\n",
      " |  \n",
      " |  GetFunctionMode(self)\n",
      " |      | **Summary**\n",
      " |      | Get imaging FUNCTION mode.\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | [0]= int\n",
      " |      |   <On TEM Observation>:  0=MAG, 1=MAG2, 2=LowMAG, 3=SAMAG, 4=DIFF \n",
      " |      |   <On STEM Observation>: 0=Align, 1=SM-LMAG, 2=SM-MAG, 3=AMAG, 4=uuDIFF, 5=Rocking\n",
      " |      | [1]= FUNCTION mode explanation string. string\n",
      " |  \n",
      " |  GetMagValue(self)\n",
      " |      | **Summary**\n",
      " |      | Get Magnification/Camera length/Rocking angle. \n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | [0]= Magnification value.(Magnification of scanning image for ASID), string\n",
      " |      | [1]= Unit string, string\n",
      " |      | [2]= Magnification label ,string\n",
      " |  \n",
      " |  GetProbeMode(self)\n",
      " |      | **Summary**\n",
      " |      | Get irradiative PROBE mode.\n",
      " |      | **return**\n",
      " |      | type: int\n",
      " |      | 0=TEM, 1=EDS, 2=NBD, 3=CBD\n",
      " |  \n",
      " |  GetSpctrMode(self)\n",
      " |      | **Summary**\n",
      " |      | Get spectrum mode status.\n",
      " |      | **return**\n",
      " |      | type: int\n",
      " |      | 0=OFF, 1=ON\n",
      " |  \n",
      " |  GetSpctrValue(self)\n",
      " |      | **Summary**\n",
      " |      | Get spectrum magnification.\n",
      " |      | **return**\n",
      " |      | type: list\n",
      " |      | [0]= long: Magnification value (um/V)\n",
      " |      | [1]= string: Unit string\n",
      " |      | [2]= string: Magnification label\n",
      " |  \n",
      " |  GetSpotSize(self)\n",
      " |      | **Summary**\n",
      " |      | Get SPOTSIZE number.\n",
      " |      | **return**\n",
      " |      | type: int\n",
      " |      | 0-7\n",
      " |  \n",
      " |  GetStemCamValue(self)\n",
      " |      | **Summary**\n",
      " |      | Get imaging side camera length(magnification) for STEM. \n",
      " |      | **return**\n",
      " |      | type: int\n",
      " |      | [0]= long: Camera length value (cm)\n",
      " |      | [1]= string: Unit string.\n",
      " |      | [2]= string: Camera length string.\n",
      " |  \n",
      " |  GetTemStemMode(self)\n",
      " |      | **Summary**\n",
      " |      | Get TEM/ASID mode.\n",
      " |      | **return**\n",
      " |      | type: int\n",
      " |      | 0=TEM, 1=ASID\n",
      " |  \n",
      " |  SelectFunctionMode(self, mode)\n",
      " |      | **Summary**\n",
      " |      | Set imaging FUNCTION mode.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | mode: \n",
      " |      |  [On TEM Observation]  0=MAG, 1=MAG2, 2=LowMAG, 3=SAMAG, 4=DIFF\n",
      " |      |  [On STEM Observation] 0=Align, 1=SM-LMAG, 2=SM-MAG, 3=AMAG, 4=uuDIFF, 5=Rocking\n",
      " |  \n",
      " |  SelectProbMode(self, mode)\n",
      " |      | **Summary**\n",
      " |      | Set irradiative PROBE mode.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | mode: \n",
      " |      | 0=TEM, 1=EDS, 2=NBD, 3=CBD\n",
      " |  \n",
      " |  SelectSpotSize(self, size)\n",
      " |      | **Summary**\n",
      " |      | Set SPOTSIZE number.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | size: \n",
      " |      | 0-7\n",
      " |  \n",
      " |  SelectTemStem(self, mode)\n",
      " |      | **Summary**\n",
      " |      | Set TEM/ASID mode.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | mode: \n",
      " |      | 0=TEM, 1=ASID\n",
      " |  \n",
      " |  SetAlphaSelector(self, value)\n",
      " |      | **Summary**\n",
      " |      | Set Alpha number.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | value: \n",
      " |      | 0-8\n",
      " |  \n",
      " |  SetBrightness(self, value)\n",
      " |      | **Summary**\n",
      " |      | Increase of decrease Lens value for BRIGHTNESS(MAG link). Same as BRIGHTNESS knob. \n",
      " |        Although full range of short type variable can be accepted. \n",
      " |        the value around +-1 to 50 is suitable because the range corresponds to that of the knob on the operation panel. \n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | value:\n",
      " |  \n",
      " |  SetDiffFocus(self, value)\n",
      " |      | **Summary**\n",
      " |      | Increase of decrease Lens value for DIFFFOCUS(MAG link). Same as DIFFFOCUS knob.\n",
      " |        Although full range of short type variable can be accepted.\n",
      " |        the value around +-1 to 50 is suitable because the range corresponds to that of the knob on the operation panel. \n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | value:\n",
      " |  \n",
      " |  SetGIF(self, mode)\n",
      " |      | **Summary**\n",
      " |      | Set GIF-mode.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | mode: \n",
      " |      | 0=OFF, 1=ON\n",
      " |  \n",
      " |  SetObjFocus(self, value)\n",
      " |      | **Summary**\n",
      " |      | Increase of decrease Lens value for OBJ Focus(MAG link). Same as OBJ Focus knob. \n",
      " |        Although full range of short type variable can be accepted. \n",
      " |        the value around +-1 to 50 is suitable because the range corresponds to that of the knob on the operation panel.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | value:\n",
      " |  \n",
      " |  SetSelector(self, value)\n",
      " |      | **Summary**\n",
      " |      | Set Magnification/Camera length/Rocking angle number.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | value:\n",
      " |  \n",
      " |  SetSpctrMode(self, mode)\n",
      " |      | **Summary**\n",
      " |      | ON/OFF spectrum mode.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | mode: \n",
      " |      | 0=OFF, 1=ON\n",
      " |  \n",
      " |  SetSpctrSelector(self, value)\n",
      " |      | **Summary**\n",
      " |      | Set spectrum magnification number.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | value:\n",
      " |  \n",
      " |  SetStemCamSelector(self, value)\n",
      " |      | **Summary**\n",
      " |      | Set imaging side camera length(magnification) number for STEM.\n",
      " |      | **arg**\n",
      " |      | type: int\n",
      " |      | value:\n",
      " |  \n",
      " |  UpSelector(self)\n",
      " |      | **Summary**\n",
      " |      | Increment Magnification/Camera length/Rocking angle number. Up the magnification selector.\n",
      " |  \n",
      " |  UpSpctrSelector(self)\n",
      " |      | **Summary**\n",
      " |      | Increment spectrum magnification number. Up the energy spectrometer selector.\n",
      " |  \n",
      " |  UpStemCamSelector(self)\n",
      " |      | **Summary**\n",
      " |      | Increment imaging side camer a length(magnification) number for STEM. Up the camera length selector.\n",
      " |  \n",
      " |  __init__(self)\n",
      " |      Initialize self.  See help(type(self)) for accurate signature.\n",
      " |  \n",
      " |  ----------------------------------------------------------------------\n",
      " |  Data descriptors defined here:\n",
      " |  \n",
      " |  __dict__\n",
      " |      dictionary for instance variables (if defined)\n",
      " |  \n",
      " |  __weakref__\n",
      " |      list of weak references to the object (if defined)\n",
      "\n"
     ]
    }
   ],
   "source": [
    "help(eos)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "0"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# TEM/Scanningの状態の取得\n",
    "eos.GetTemStemMode()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# Scanningに変更\n",
    "eos.SelectTemStem(1)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "## Lens"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# 初期処理\n",
    "lens = TEM3.Lens3()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[0, 4095]"
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# CL3値の取得 (0 - 65535)\n",
    "lens.GetCL3()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "# CL3値の変更(0 - 65535)\n",
    "lens.SetCL3(4095)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {
    "collapsed": true
   },
   "source": [
    "## Stage"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# 初期処理\n",
    "stage = TEM3.Stage3()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Help on Stage3 in module PyJEM.offline.TEM3.stage3 object:\n",
      "\n",
      "class Stage3(builtins.object)\n",
      " |  Methods defined here:\n",
      " |  \n",
      " |  GetDirection(self)\n",
      " |      | **Summary**\n",
      " |      | Get driving direction. 0:-direction, 1:+direction\n",
      " |      | **return**\n",
      " |      | type: list \n",
      " |      | [0]= int: X\n",
      " |      | [1]= int: Y\n",
      " |      | [2]= int: Z\n",
      " |      | [3]= int: TiltX\n",
      " |      | [4]= int: TiltY\n",
      " |  \n",
      " |  GetDrvMode(self)\n",
      " |      | **Summary**\n",
      " |      | Get selection on motor/piezo.\n",
      " |      | **return**\n",
      " |      | type: int \n",
      " |      | 0=Motor, 1=Piezo\n",
      " |  \n",
      " |  GetHolderStts(self)\n",
      " |      | **Summary**\n",
      " |      | Get holder status(inserted or not).\n",
      " |      | **return**\n",
      " |      | type: int \n",
      " |      | 0=OUT, 1=IN\n",
      " |  \n",
      " |  GetPiezoPosi(self)\n",
      " |      | **Summary**\n",
      " |      | Get piezo position. \n",
      " |      | **return**\n",
      " |      | type: list \n",
      " |      | [0]= float: X Range:+-100000.0(nm)\n",
      " |      | [1]= float: Y Range:+-10000.00(nm)\n",
      " |  \n",
      " |  GetPos(self)\n",
      " |      | **Summary**\n",
      " |      | Get motor position. \n",
      " |      | **return**\n",
      " |      | type: list \n",
      " |      | [0]= float: X Range:+-100000.0(nm)\n",
      " |      | [1]= float: Y Range:+-100000.0(nm)\n",
      " |      | [2]= float: Z Range:+-100000.0(nm)\n",
      " |      | [3]= float: TiltX Range:+-90.00(degree)\n",
      " |      | [4]= float: TiltY Range:+-180.00(degree)\n",
      " |  \n",
      " |  GetStatus(self)\n",
      " |      | **Summary**\n",
      " |      | Get driving status. \n",
      " |      | **return**\n",
      " |      | type: list \n",
      " |      | 0=Rest, 1=Moving, 2=Hardware limiter error.\n",
      " |      | [0]->int: X\n",
      " |      | [1]->int: Y\n",
      " |      | [2]->int: Z\n",
      " |      | [3]->int: TiltX\n",
      " |      | [4]->int: TiltY\n",
      " |  \n",
      " |  SelDrvMode(self, sw)\n",
      " |      | **Summary**\n",
      " |      | Select motor/piezo.\n",
      " |      | **arg**\n",
      " |      | type: int \n",
      " |      | sw: 0=Motor, 1=Piezo\n",
      " |  \n",
      " |  SetOrg(self)\n",
      " |      | **Summary**\n",
      " |      | Move to origin. Moving order: TiltY, TiltX, X, Z, Y\n",
      " |  \n",
      " |  SetPosition(self, x, y)\n",
      " |      | **Summary**\n",
      " |      | Set X-Y axis drive(with rotation compensation)\n",
      " |      | **arg**\n",
      " |      | type: int \n",
      " |      | x: float, x Range:+-100000.0(nm)\n",
      " |      | y: float, y Range:+-100000.0(nm)\n",
      " |  \n",
      " |  SetTXRel(self, value)\n",
      " |      | **Summary**\n",
      " |      | Relative tilt around TiltX.\n",
      " |      | **arg**\n",
      " |      | type: int \n",
      " |      | value: +-90.00 (degree)\n",
      " |  \n",
      " |  SetTYRel(self, value)\n",
      " |      | **Summary**\n",
      " |      | Relative tilt around TiltY.\n",
      " |      | **arg**\n",
      " |      | type: int \n",
      " |      | value: +-90.00 (degree)\n",
      " |  \n",
      " |  SetTiltXAngle(self, value)\n",
      " |      | **Summary**\n",
      " |      | Set TiltX\n",
      " |      | **arg**\n",
      " |      | type: int \n",
      " |      | value: +-90.00 (degree)\n",
      " |  \n",
      " |  SetTiltYAngle(self, value)\n",
      " |      | **Summary**\n",
      " |      | Set TiltY\n",
      " |      | **arg**\n",
      " |      | type: int \n",
      " |      | value: +-90.00 (degree)\n",
      " |  \n",
      " |  SetX(self, value)\n",
      " |      | **Summary**\n",
      " |      | Set X axis drive. \n",
      " |      | **arg**\n",
      " |      | type: int \n",
      " |      | value: \n",
      " |      |  For motor drive Range: +-100000.0(nm)\n",
      " |      |  For piezo Range: +-10000.00(nm)\n",
      " |  \n",
      " |  SetXRel(self, value)\n",
      " |      | **Summary**\n",
      " |      | Relative move along X axis.\n",
      " |      | **arg**\n",
      " |      | type: int \n",
      " |      | value: \n",
      " |      |  For motor drive Range: +-100000.0(nm)\n",
      " |      |  For piezo Range: +-10000.00(nm)\n",
      " |  \n",
      " |  SetY(self, value)\n",
      " |      | **Summary**\n",
      " |      | Set Y axis drive. \n",
      " |      | **arg**\n",
      " |      | type: int \n",
      " |      | value: \n",
      " |      |  For motor drive Range: +-100000.0(nm)\n",
      " |      |  For piezo Range: +-10000.00(nm)\n",
      " |  \n",
      " |  SetYRel(self, value)\n",
      " |      | **Summary**\n",
      " |      | Relative move along Y axis.\n",
      " |      | **arg**\n",
      " |      | type: int \n",
      " |      | value: \n",
      " |      |  For motor drive Range: +-100000.0(nm)\n",
      " |      |  For piezo Range: +-10000.00(nm)\n",
      " |  \n",
      " |  SetZ(self, value)\n",
      " |      | **Summary**\n",
      " |      | Set Z axis drive. \n",
      " |      | **arg**\n",
      " |      | type: int \n",
      " |      | value: \n",
      " |      |  For motor drive Range: +-100000.0(nm)\n",
      " |      |  For piezo Range: +-10000.00(nm)\n",
      " |  \n",
      " |  SetZRel(self, value)\n",
      " |      | **Summary**\n",
      " |      | Relative move along Z axis.\n",
      " |      | **arg**\n",
      " |      | type: int \n",
      " |      | value: \n",
      " |      |  For motor drive Range: +-100000.0(nm)\n",
      " |      |  For piezo Range: +-10000.00(nm)\n",
      " |  \n",
      " |  Stop(self)\n",
      " |      | **Summary**\n",
      " |      | Stop all the drives.\n",
      " |  \n",
      " |  __init__(self)\n",
      " |      Initialize self.  See help(type(self)) for accurate signature.\n",
      " |  \n",
      " |  ----------------------------------------------------------------------\n",
      " |  Data descriptors defined here:\n",
      " |  \n",
      " |  __dict__\n",
      " |      dictionary for instance variables (if defined)\n",
      " |  \n",
      " |  __weakref__\n",
      " |      list of weak references to the object (if defined)\n",
      "\n"
     ]
    }
   ],
   "source": [
    "help(stage)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 23,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "[100.0, 0.0, 0.0, 0.0, 0.0]"
      ]
     },
     "execution_count": 23,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "# Stageの座標取得\n",
    "stage.GetPos()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "# Motor駆動でX軸相対値移動\n",
    "stage.SetXRel(100)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.8.10"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 1
}
